@model easyPC.Models.Encomenda

@{
    ViewData["Title"] = "Detalhes da Encomenda";
}

@if (TempData["EtapaMessage"] != null)
{
    <div class="alert alert-info">
        @TempData["EtapaMessage"]
    </div>
}

<h2>@ViewData["Title"]</h2>

<div>
    <h4>Encomenda</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">Data</dt>
        <dd class="col-sm-10">@Model.Data.ToString("dd/MM/yyyy")</dd>

        <dt class="col-sm-2">Estado</dt>
        <dd class="col-sm-10">@Model.Estado</dd>

        <dt class="col-sm-2">Cliente</dt>
        <dd class="col-sm-10">@Model.Cliente.Email</dd>

        @if (Model.Montagem != null)
        {
            <dt class="col-sm-2">Montagem</dt>
            <dd class="col-sm-10">
                Etapa @Model.Montagem.EtapaAtual — Início: @Model.Montagem.DataInicio.ToShortDateString()
                @if (Model.Montagem.EtapaAtual < 6)
                {
                    <form asp-controller="Montagens" asp-action="AvancarEtapa" asp-route-id="@Model.Montagem.Id" method="post" class="d-inline ms-2">
                        <button type="submit" class="btn btn-sm btn-primary">Avançar Etapa</button>
                    </form>
                }
            </dd>
        }
    </dl>
</div>

@if (Model.EncomendaComponentes != null && Model.EncomendaComponentes.Any())
{
    <h4>Componentes</h4>
    <ul>
        @foreach (var ec in Model.EncomendaComponentes)
        {
            <li>@ec.Componente.Tipo: @ec.Componente.Marca @ec.Componente.Modelo</li>
        }
    </ul>
}

<div class="mt-3">
    <a asp-controller="Montagens" asp-action="Create" asp-route-encomendaId="@Model.Id" class="btn btn-success btn-sm">Criar Montagem</a>
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning btn-sm">Editar</a>
    <a asp-action="Index" class="btn btn-secondary btn-sm">Voltar à lista</a>
</div>
